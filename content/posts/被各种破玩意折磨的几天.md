---
title: 被各种玩意折磨的几天
date: 2020-09-08T18:00:00+08:00
lastmod: 2020-09-08T18:00:00+08:00
author: 林二狗
# authorlink: https://author.site
cover: /img/cover1.jpg
categories:
  - 随笔
tags:
  - 坑爹
  - wordpress
  - cms
  - docker
# showcase: true
draft: false
---

## 生活不易 二狗叹气

> 客观正确的选择与及时止损以及在客观正确的道路上持之以恒  
> 是达成目标的走钢丝表演

二狗虽踩坑无数，若是眼拙踩了坑，吃一堑长一智倒也无妨，可这几天被坑的感觉就是 **坑爹呢！这是**  

最后对linux中修改配置文件的管理方式深恶痛绝，为什么不做个web控制面板，知道文件配置有多低效和易错么。

---

### 第一天

起因是想做个官网，直接找模板开发呢感觉很划不来，还要配套后台进行登录管理内容。其实就是需要一个CMS系统，市面上五花八门的不要太多。几天时间调研折腾，最终选定SiteServerCMS。为什么呢，一这个开源不要钱。二虽然模板不多，但也还看得下去。三技术栈差不多也容易安装部署。于是开始被坑爹了。

安装部署都还好，运行开始就开坑了。系统默认是通过url第一级地址跳转到后台创建的不同站点，是动态访问方式。CMS重要的功能不就是生成静态页面的任意部署么，这个SiteServer倒是有生成静态页功能，但是当你生成了后访问就会发现，静态资源的地址都是错的完全加载不出来。折腾半天发现有个站点设置里的访问地址设置成斜杠`/`才行，中间完全没有任何提示这个设置的作用是什么有什么影响，填写规则是什么都没有，全凭经验猜的。  
折腾好静态资源后可算是能用了吧，选择在线模板，使用生成，输入域名查看，成功！  
当时从中午两三点开始调研部署点点按按，再到最后通过域名访问成功已经是凌晨三点。好在成功在望，虽然模板不多也不好看，想着将就下吧，第二天来修改文案正式上线。

---

### 第二天

有事

---

### 第三天

上来就坑爹，想先添加个logo吧，找到修改logo的地方，改了没用，保存，刷新，界面值复原，查看数据库，找到存有该文件路径值的字段，查看，是修改过后的，但是界面还是复原，不知道是这破系统bug还是存在了其它地方，总之就是不行。要改改文字菜单应该是可以，但是想修改logo，不好意思，就是不行。甚是蛋疼，不知是不是故意恶心人，引导去购买他们的VIP服务。就这已经折腾了好几个小时，气不打一处来。破玩意，很久没更新了，模板也就几个也不咋地，还这么恶心用起来。要说真是改不了么，大不了修改模板里的html，手动写死，我不信还加载不出个图片，还不行反编译这破代码帮你们修修“bug”?  
去他大爷的，破玩意，我还不想用了呢。

于是开始研究wordpress  
毕竟专业团队，用户庞大，多年招牌，模板五花八门是不断更新  
于是开始被新的坑

看官网文档，就不能写个树形文档么，点进去又要返回，所有章节一堆挤在眼前，没个先后主次，跟翔一样，看这个浪费时间。  
自行搜索，发现手动安装配置各种繁琐，就一个破php我就想叫它滚犊子，好在有docker这个东西，正好要用。  
于是docker上，上来就完犊子，反正按某个博客写的一顿搞，发现，不行。显示mysql镜像起来就挂，这好说应该是内存不足，毕竟我这1G的服务器已经跑了MongoDB等一些乱七八糟的软件，于是将mysql安装到另一个服务器，再各种配置远程访问。回来再试，启动后，天真的我设置nginx代理到本地docker容器的端口，以为就行了，设置也很简单，nginx只会简单用。打开浏览器输入域名，好一会，出来了WordPress的引导界面。  
还没来得及高兴，发现破玩意静态资源又没有，且html的路径是localhost（现在发现可能是nginx配置的问题导致WordPress初始化没有把地址识别为请求的域名地址，这个坑可能是要怪自己才疏学浅）。又是几个小时瞎几把折腾，都不球行。蛋疼。  
此时萌生想法换到windows server上试试，正好还能和mysql在一起。先发现一个通过什么web platform installer的玩意可以直接安装WordPress，不用自己去搞什么php等等配置。于是尝试乎，TMD可能是服务器在国外，阿里云里各种JB慢，十几KB的下载速度，先不管吧，去研究其它方法吧。于是发现个xampp的玩意。因为WordPress默认是Apache代理，这玩意就是整合了Apache php mysql等等玩意，一键安装，那个好啊。一阵操作之后，还真搞起WordPress了，以为终于见到了曙光。回头说那个十几KB下载，不知等了多久，显示下载完成，然后就是安装中，然后就是永远也安装不动，这鸡八玩意感觉就是假死，中间开开关关还几次，下载下不动，显示下好了，安安不动，查看进程一点CPU硬盘都不用，你tm在这装什么死。恶心。  
说windows server上跑起来了wordpress了，蛋疼的事又来了，因为这玩意是一个叫xampp的什么玩意集成的Apache代理的，我IIS也在用，这80和443就没办法分啊，给Apache设置其它端口，iis代理吧，能行，但是又是静态资源出不来或者重定向过多等莫名其妙的问题，且不说WordPress里自己还有个设置站点地址的地方，不知道会不会影响到端口的绑定和Apache监听端口又有什么联系，反正各种破事真的蛋疼。要想共存排查起问题变量太多，都不知从何下手，简单的方法也有，再买个服务器专门跑这个Apache，反正想想蛋疼，又是折腾到两三点的一天。  

期间还有个很傻的事  
我默认下的最新的WordPress的windows版文件，怎么跑怎么都跑步起来，各种原因都找不到。  
最后抱着试一试下了个稍微早一点的版本，TMD，就TMD跑起来了
有这么坑爹的吗？  
有这么坑爹的吗？  
有这么坑爹的吗？  
要不是我真的脑洞大开，难道要坑死我在这吗？

---

### 第四天

有事

---

### 第五天

抱着试一试再搞下docker的想法 这次加入nginx的条件一起查找资料  
发现大多用docker-compose去配置，之前看到懒得试，现在决定试试  
基本摸清这玩意怎么使之后，找了个靠谱的文章，一顿操作，去掉配置里我这已经跑在外面的mysql和nginx，再把他nginx的配置搬到我的nginx里，又是一顿操作  
输入域名，502 Bad Gateway  
心中一丝蛋疼，但是感觉问题不大，看来看去感觉应该就是nginx配置还有点问题，可又感觉不可能吧。  
其实写反向代理的地址时我是有一点怀疑的，文章里在那个位置写的是IP，一般不都是localhost的吗，就算要IP，localhost也差不多吧，于是我还是写的localhost，然后就是502。  
抱着试一试的态度，改成127.0.0.1，然后，卧槽，真的是这个问题，终于正常跑了个WordPress起来。

试了试没啥问题了，就是慢，考虑到这台弱鸡服务器的情况，数据库又是从香港的腾讯云服务器连到杭州的阿里云，我又在大陆访问，应该就是需要买台大陆的服务器了。

我好难，我就想建个官网怎么这么难。  
呜呜呜呜。

......

又过了几个小时  
买了新服务器想要同时配置mysql和WordPress的容器，又是一堆坑  
又是几个小时终于真的以我想要的方式搞定了

......

最后几小时主要还是有这么一个坑：

docker的容器之间不能直接通过 127.0.0.1+端口 通信  
每个容器都是虚拟一个网卡，一个172.xx.0.1的虚拟地址和主机通信  
所以容器间通信的方法有  

* 找到需要通信的容器的虚拟地址，配置到请求容器的相关配置中

* 使用docker-compose的link或者depend-on，使用后可以直接在配置中使用对应的容器services名称代表该容器的ip进行配置（实现的原理应该是docker-compose把别名添加到host中，地址是对应容器的虚拟地址，达到通信效果）

---

学习了学习了  
社会社会  
呜呜呜呜呜
